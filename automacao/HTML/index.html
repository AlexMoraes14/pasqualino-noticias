<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Workspace Pasqualino</title>
  <link rel="stylesheet" href="../CSS/index.css">
</head>
<body>

<div class="container">
  <div class="card">
    <div class="logo-container">
      <img src="../imagens/logo-oficial.png" alt="Logo Pasqualino">
    </div>

    <input
      id="email"
      type="email"
      placeholder="Digite seu e-mail (@pasqualino.com.br)"
      pattern=".+@pasqualino\.com(\.br)?"
      required
    >

    <select required>
      <option value="">Selecione seu departamento</option>
      <option>Auxiliar Administrativo</option>
      <option>CMR</option>
      <option>Contabil</option>
      <option>CS</option>
      <option>Departamento Pessoal</option>
      <option>Financeiro</option>
      <option>Fiscal</option>
      <option>Legalizacao</option>
      <option>Marketing</option>
      <option>RH</option>
      <option>T.I</option>
    </select>

    <a href="noticias.html" class="btn-primary">
      Entrar
    </a>

    <button class="btn-primary btn-admin" onclick="entrarAdmin()">
      Entrar como admin
    </button>
  </div>
</div>

<a class="contato btn-secondary" href="contato.html">
  Entre em contato
</a>

<script>
async function entrarAdmin() {
  const email = document.getElementById('email').value.trim().toLowerCase();

  if (!email) {
    alert('Digite seu e-mail corporativo.');
    return;
  }

  if (!/@pasqualino\.com(\.br)?$/.test(email)) {
    alert('Use um e-mail corporativo valido.');
    return;
  }

  try {
    const response = await fetch('../api/login_admin.php', {
      method: 'POST',
      credentials: 'same-origin',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: `email=${encodeURIComponent(email)}`
    });

    const data = await response.json();
    if (!response.ok || !data.success) {
      alert('Acesso negado: ' + (data.message || 'sem permissao'));
      return;
    }

    window.location.href = 'adm.html';
  } catch (err) {
    console.error('Erro ao autenticar admin:', err);
    alert('Erro ao autenticar admin. Tente novamente.');
  }
}
</script>

</body>
</html>
